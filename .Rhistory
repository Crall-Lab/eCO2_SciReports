scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.flowers)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y = "log(Days since planting)")
View(W.FF)
str(W.FF)
ggplot(ff, aes(x=Plant, y = log10(datenum), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.flowers)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y = "log(Days since planting)")
# remove any plant, date, round, chambers w/o 3+ observations
W.FF$CO2 <- as.factor(W.FF$CO2)
W.FF$Plant <- as.factor(W.FF$Plant)
W.FF <- W.FF %>% group_by(Plant, Chamber, Round) %>% filter(n()>2) %>% ungroup()
ff.1 <- W.FF %>% filter(Round == "1")
start.date <- parse_date_time('2021-11-17 00:00:00', "%Y-%m-%d %H:%M:%S")
ff.1$datenum <- as.numeric(difftime(parse_date_time(ff.1$Date, 'ymd'),start.date))
ff.2 <- W.FF %>% filter(Round == "2")
start.date <- parse_date_time('2022-01-20 00:00:00', "%Y-%m-%d %H:%M:%S")
ff.2$datenum <- as.numeric(difftime(parse_date_time(ff.2$Date, 'ymd'),start.date))
ff<- rbind(ff.1, ff.2)
ggplot(ff, aes(x=Plant, y = log10(datenum), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.flowers)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y = "log(Days since planting)")
View(W.FF)
## Buckwheat
ff.BW <- ff %>% filter(Plant == "BW")
m.B1 <- lmer(datenum ~ CO2 + Round + (1|Chamber), data = ff.BW, REML=F)
summary(m.B1)
# remove NAs'
W.area <- W.area %>% filter(!is.na(Plant))
# remove any plant, date, round, chambers w/o 3+ observations
area <- W.area %>% group_by(Plant, CO2) %>% filter(n()>2) %>% ungroup()
ggplot(area, aes(x=Plant, y = log(Mean), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.3, alpha = 0.3, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .5),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y = "ln(Flower diameter)")
ggplot(area, aes(x=Plant, y = log(Mean), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.3, alpha = 0.3, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.flowers)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .5),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y = "ln(Flower diameter)")
ggplot(BM, aes(x=Plant, y = log(Plant.biomass), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.height)#+
##############
## biomass
# only from round 1
BM <- biomass %>% group_by(Plant, CO2) %>% filter(n()>2) %>% ungroup()
ggplot(BM, aes(x=Plant, y = log(Plant.biomass), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.height)#+
ggplot(BM, aes(x=Plant, y = log(Plant.biomass), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.height)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
labs(y="ln(Above-ground dry biomass)")
source("~/.active-rstudio-document")
##############################
## read in the data frames
W.pollen<-read.csv(file = "Pollen_chemistry_exp2.csv", header = T, na.strings = c("", "NULLL"))
H.pollen <- read.csv(file = "Pollen_chemistry_exp1.csv", header = T, na.string = c("", "NULL"))
# Pollen nutrition
W.pollen$Plant_SP <- factor(W.pollen$Plant_SP, levels = c("B", "BW", "C", "D", "LP", "N", "PP", "SA", "SF"))
W.pollen$Chamber <- factor(W.pollen$Chamber, levels = c("60", "63", "62", "61"))
# omit bad samples, duplicates
W.pollen <- W.pollen %>% filter(is.na(OMIT))
# add C:N ratio column
W.pollen$ratio <- W.pollen$C/W.pollen$N
# remove plants, rounds, and chambers w/fewer than 3 samples
H.short <- H.pollen %>% group_by(Plant, CO2, Round) %>% filter(n()>2) %>% ungroup()
H.sum <- H.short %>% group_by(Plant, CO2) %>%
dplyr::summarise(
count = n(),
mean = mean(N, na.rm = T),
sd = sd(N, na.rm = T)
)
H.sum$se <- H.sum$sd/sqrt(H.sum$count)
H.sum$Variable <- "N"
# plot it
plants.1 <- c("Buckwheat","Melon", "Partridge pea", "Poppy", "Squash", "Sunflower", "Tomatillo", "Tomato")
names(plants.1) <- c("buckwheat", "melon", "partridge pea", "poppy", "squash", "sunflower", "tomatillo", "tomato")
ggplot(H.sum, aes(x=Plant, y = mean, shape = CO2))+
geom_point(position = position_dodge(w = 0.75), size = 2)+
geom_errorbar(aes(ymin=mean-se, ymax = mean+se), position = position_dodge(w = 0.75), width=0.2)+
theme_classic()+
theme(legend.position = c(.1,.8))+
labs(y="%N +/- se", x = "Plant species")+
scale_shape_manual(values = c(1,16), labels = c("aCO2", "eCO2"), name = "Treatment")
H.short$ratio <- H.short$C/H.short$N
H.sum1 <- H.short %>% group_by(Plant, CO2) %>%
dplyr::summarise(
count = n(),
mean = mean(ratio, na.rm = T),
sd = sd(ratio, na.rm = T)
)
H.sum1$se <- H.sum1$sd/sqrt(H.sum1$count)
H.sum1$Variable <- "C:N"
ggplot(H.sum1, aes(x=Plant, y = mean, shape = CO2))+
geom_point(position = position_dodge(w = 0.75), size = 2)+
geom_errorbar(aes(ymin=mean-se, ymax = mean+se), position = position_dodge(w = 0.75), width=0.2)+
theme_classic()+
theme(legend.position = c(.9,.8))+
labs(y="C:N ratio +/- se", x = "Plant species")+
scale_shape_manual(values = c(1,16), labels = c("aCO2", "eCO2"), name = "Treatment")
H.sum2 <- H.short %>% group_by(Plant, CO2) %>%
dplyr::summarise(
count = n(),
mean = mean(C, na.rm = T),
sd = sd(C, na.rm = T)
)
H.sum2$se <- H.sum2$sd/sqrt(H.sum2$count)
H.sum2$Variable <- "C"
ggplot(H.sum2, aes(x=Plant, y = mean, shape = CO2))+
geom_point(position = position_dodge(w = 0.75), size = 2)+
geom_errorbar(aes(ymin=mean-se, ymax = mean+se), position = position_dodge(w = 0.75), width=0.2)+
theme_classic()+
theme(legend.position = c(.9,.2))+
labs(y="%C +/- se", x = "Plant species")+
scale_shape_manual(values = c(1,16), labels = c("aCO2", "eCO2"), name = "Treatment")
H.p <- rbind(H.sum, H.sum1, H.sum2)
H.p$Variable <- factor(H.p$Variable, levels = c("N", "C", "C:N"))
ggplot(H.p, aes(x=Plant, y = mean, color = CO2))+
geom_point(position = position_dodge(w = 0.75), size = 2)+
geom_errorbar(aes(ymin=mean-se, ymax = mean+se), position = position_dodge(w = 0.75), width=0.2)+
theme_classic()+
theme(legend.position = "bottom")+
labs( y = "Mean +/- s.e.")+
scale_color_manual(values = c("grey","navyblue"),
labels = c("aCO2", "eCO2"))+
scale_x_discrete(labels = c(plants))+
facet_wrap(vars(Variable), scales = "free",
ncol = 1)
N<-ggplot(H.short, aes(x= Plant, y = log(N), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
C<- ggplot(H.short, aes(x= Plant, y = C, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
CN<-ggplot(H.short, aes(x= Plant, y = ratio, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())
ggarrange(N, C, CN, nrow=3, ncol = 1, align = "h")
ggplot(H.short, aes(x= Plant, y = N, fill = CO2))+
geom_violin()+
geom_boxplot(width=0.1, aes(fill = CO2), position=position_dodge(.9))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank())
library(ggpubr)
ggarrange(N, C, CN, nrow=3, ncol =1, align = "h")
# remove plants, rounds, and chambers w/fewer than 3 samples
H.short <- H.pollen %>% group_by(Plant, CO2, Round) %>% filter(n()>2) %>% ungroup()
View(H.short)
H.short <- H.short %>% filter(!is.na(OMIT))
H.short <- H.short %>% filter(!is.na(Omit))
plants.1 <- c("Buckwheat","Melon", "Partridge pea", "Poppy", "Squash", "Sunflower", "Tomatillo", "Tomato")
names(plants.1) <- c("buckwheat", "melon", "partridge pea", "poppy", "squash", "sunflower", "tomatillo", "tomato")
H.short$ratio <- H.short$C/H.short$N
N<-ggplot(H.short, aes(x= Plant, y = log(N), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.1)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
C<- ggplot(H.short, aes(x= Plant, y = C, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
CN<-ggplot(H.short, aes(x= Plant, y = ratio, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())
ggarrange(N, C, CN, nrow=3, ncol =1, align = "h")
C<-
ggplot(H.short, aes(x= Plant, y = C, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
plot(C)
View(H.short)
# remove plants, rounds, and chambers w/fewer than 3 samples
H.short <- H.pollen %>% group_by(Plant, CO2, Round) %>% filter(n()>2) %>% ungroup()
H.short <- H.short %>% filter(is.na(Omit))
plants.1 <- c("Buckwheat","Melon", "Partridge pea", "Poppy", "Squash", "Sunflower", "Tomatillo", "Tomato")
names(plants.1) <- c("buckwheat", "melon", "partridge pea", "poppy", "squash", "sunflower", "tomatillo", "tomato")
H.short$ratio <- H.short$C/H.short$N
N<-ggplot(H.short, aes(x= Plant, y = log(N), fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants.1)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
C<- ggplot(H.short, aes(x= Plant, y = C, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))
CN<-ggplot(H.short, aes(x= Plant, y = ratio, fill = CO2))+
geom_violin()+
geom_point(position=position_jitterdodge(), size = 0.5, alpha = 0.5, aes(color=CO2))+
theme_classic()+
scale_fill_manual(values = c("grey", "cornflowerblue"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_color_manual(values = c("black", "navy"),
labels = c("aCO2", "eCO2"),
name = "CO2 Treatment")+
scale_x_discrete(labels = plants)+
stat_summary(fun = "mean",
fun.args = list(mult = 1),
geom="crossbar",
color = "black",
width=.75,
position=position_dodge(0.9))+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, hjust=1, size = .2),
axis.title.x=element_blank())
ggarrange(N, C, CN, nrow=3, ncol =1, align = "h")
##############################
## read in the data frames
W.pollen<-read.csv(file = "Pollen_chemistry_exp2.csv", header = T, na.strings = c("", "NULLL"))
H.pollen <- read.csv(file = "Pollen_chemistry_exp1.csv", header = T, na.string = c("", "NULL"))
# clean data frames
# Pollen nutrition exp 1
H.pollen <- H.pollen %>% filter(is.na(Omit))
H.pollen$CO2 <- as.factor(H.pollen$CO2)
H.pollen$Round <- as.factor(H.pollen$Round)
H.pollen$Plant <- as.factor(H.pollen$Plant)
# Pollen nutrition exp 2
W.pollen$Plant_SP <- factor(W.pollen$Plant_SP, levels = c("B", "BW", "C", "D", "LP", "N", "PP", "SA", "SF"))
W.pollen$Chamber <- factor(W.pollen$Chamber, levels = c("60", "63", "62", "61"))
# omit samples that were too low and duplicates
W.pollen <- W.pollen %>% filter(is.na(OMIT))
detach("package:ggplot2", unload = TRUE)
detach("package:ggpubr", unload = TRUE)
detach("package:see", unload = TRUE)
detach("package:base", unload = TRUE)
detach("package:beeswarm", unload = TRUE)
detach("package:chron", unload = TRUE)
detach("package:datasets", unload = TRUE)
detach("package:DHARMa", unload = TRUE)
detach("package:dplyr", unload = TRUE)
detach("package:forcats", unload = TRUE)
detach("package:ggplot2", unload = TRUE)
detach("package:GLMMadaptive", unload = TRUE)
detach("package:graphics", unload = TRUE)
detach("package:grDevices", unload = TRUE)
detach("package:jsonlite", unload = TRUE)
detach("package:JWileymisc", unload = TRUE)
detach("package:lme4", unload = TRUE)
detach("package:lmerTest", unload = TRUE)
detach("package:lubridate", unload = TRUE)
detach("package:Matrix", unload = TRUE)
